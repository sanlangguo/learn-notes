## 13-字节码（一）：V8为什么又重新引入字节码

本文介绍了V8引擎的编译流水线，以及字节码在其中的作用。V8引擎在执行JavaScript代码之前，需要将其编译为字节码，然后再解释执行字节码或者将字节码编译为二进制代码然后再执行。

### 早期V8引擎的执行流程
早期的V8引擎采用了直接将JavaScript代码编译为机器代码的方式，其执行流程如下：

将JavaScript代码转换为抽象语法树(AST)。
基线编译器将抽象语法树编译为未优化过的机器代码。
V8直接执行这些未优化过的机器代码。
如果V8检测到某段代码重复执行的概率过高，那么V8会将该段代码标记为HOT。
标记为HOT的代码会被优化编译器优化为执行效率更高的机器代码。
引入字节码的原因
早期的V8引擎中，将JavaScript代码直接编译为机器代码虽然能够提高执行效率，但是编译时间长且内存占用高，不利于代码的快速启动和运行。因此，V8团队重新引入了字节码作为中间代码，以提高启动速度和降低内存占用。

### 字节码的作用
在新版的V8引擎中，字节码有两个作用：

### 解释器可以直接解释执行字节码。
优化编译器可以将字节码编译为二进制代码，然后再执行二进制机器代码。

### 总结
本文介绍了早期V8引擎和新版V8引擎的执行流程，并介绍了字节码在其中的作用。新版V8引擎重新引入字节码作为中间代码，以提高启动速度和降低内存占用。